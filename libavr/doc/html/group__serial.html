<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>libavr: Elementary Serial Communications Functions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>Elementary Serial Communications Functions</h1>  </div>
</div>
<div class="contents">
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__serial.html#ga7a8efe7f4cd2338deff8bd2c52a6f56b">serial_available</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__serial.html#ga2559ff325a5d03218c7020e0f0e6dcda">serial_begin</a> (uint32_t baudrate)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__serial.html#ga1c3bc0d4ec8ae917b559e0788a1e2536">serial_end</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__serial.html#ga04858117b8541474fe79c45a044b59cc">serial_flush</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__serial.html#ga02db400d599afe33dceff17cd281f8c3">serial_in</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__serial.html#gafa8f73ae47320346b1efb251ac188d45">serial_out</a> (const char *fmt,...)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__serial.html#gaf5d688600f05137b44dd915a9bb0686c">serial_write</a> (uint8_t *buff, uint8_t size)</td></tr>
</table>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ga7a8efe7f4cd2338deff8bd2c52a6f56b"></a><!-- doxytag: member="serial.h::serial_available" ref="ga7a8efe7f4cd2338deff8bd2c52a6f56b" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t serial_available </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Gets the number of bytes that have arrived from the serial port and are available for reading from the 128 byte buffer. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>uint8_t bytes available in the serial receive buffer up to 128.</dd></dl>
<p>Example: </p>
<div class="fragment"><pre class="fragment">        <span class="keywordtype">void</span> loop()
        {
                <span class="keywordflow">if</span>(<a class="code" href="group__serial.html#ga7a8efe7f4cd2338deff8bd2c52a6f56b" title="Gets the number of bytes that have arrived from the serial port and are available for reading from th...">serial_available</a>() &gt; 16) 
                {
                        process_serial_input();
                }
        }
</pre></div> 
<p>Definition at line <a class="el" href="serial_8c_source.html#l00135">135</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga2559ff325a5d03218c7020e0f0e6dcda"></a><!-- doxytag: member="serial.h::serial_begin" ref="ga2559ff325a5d03218c7020e0f0e6dcda" args="(uint32_t baudrate)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void serial_begin </td>
          <td>(</td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>baudrate</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sets up the serial communication with the transmission data rate (baudrate).</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>baudrate,:</em>&nbsp;</td><td>32-bit integer (uint32_t). Recommended that you only use one of the standard rates of: 300, 1200, 2400, 4800, 9600, 14400, 19200, 28800, 38400, 57600, or 115200.</td></tr>
  </table>
  </dd>
</dl>
<p>Example: </p>
<div class="fragment"><pre class="fragment">        <span class="keywordtype">void</span> setup()
        {
                <span class="comment">// Set up serial port for 57600 baud</span>
                <a class="code" href="group__serial.html#ga2559ff325a5d03218c7020e0f0e6dcda">serial_begin</a>(57600);
        }
</pre></div> 
<p>Definition at line <a class="el" href="serial_8c_source.html#l00086">86</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga1c3bc0d4ec8ae917b559e0788a1e2536"></a><!-- doxytag: member="serial.h::serial_end" ref="ga1c3bc0d4ec8ae917b559e0788a1e2536" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void serial_end </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the serial communications elements to their default values. </p>
<p>Example: </p>
<div class="fragment"><pre class="fragment">        <span class="keywordtype">void</span> shut_down()
        {
                <a class="code" href="group__serial.html#ga1c3bc0d4ec8ae917b559e0788a1e2536" title="Returns the serial communications elements to their default values.">serial_end</a>();
                sleep();
        }
</pre></div> 
<p>Definition at line <a class="el" href="serial_8c_source.html#l00162">162</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga04858117b8541474fe79c45a044b59cc"></a><!-- doxytag: member="serial.h::serial_flush" ref="ga04858117b8541474fe79c45a044b59cc" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void serial_flush </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Clear out any data in the serial buffer. Subsequent calls to <a class="el" href="group__serial.html#ga02db400d599afe33dceff17cd281f8c3" title="Inputs incoming serial data one byte at a time, returns -1 if no data is available.">serial_in()</a> or <a class="el" href="group__serial.html#ga7a8efe7f4cd2338deff8bd2c52a6f56b" title="Gets the number of bytes that have arrived from the serial port and are available for reading from th...">serial_available()</a> will only return data that has arrived since the call to <a class="el" href="group__serial.html#ga04858117b8541474fe79c45a044b59cc" title="Clear out any data in the serial buffer. Subsequent calls to serial_in() or serial_available() will o...">serial_flush()</a>. </p>
<p>Example: </p>
<div class="fragment"><pre class="fragment">        <span class="comment">// Received unknown command, restart the conversation </span>
        <a class="code" href="group__serial.html#gafa8f73ae47320346b1efb251ac188d45" title="Outputs formatted data based on conversion symbols and escape character sequences contained in a stri...">serial_out</a>(<span class="stringliteral">&quot;Unknown command: %d, flushing buffer.&quot;</span>, last_command);
        <span class="comment">// Throw out everything</span>
        <a class="code" href="group__serial.html#ga04858117b8541474fe79c45a044b59cc" title="Clear out any data in the serial buffer. Subsequent calls to serial_in() or serial_available() will o...">serial_flush</a>();
</pre></div> 
<p>Definition at line <a class="el" href="serial_8c_source.html#l00153">153</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga02db400d599afe33dceff17cd281f8c3"></a><!-- doxytag: member="serial.h::serial_in" ref="ga02db400d599afe33dceff17cd281f8c3" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t serial_in </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Inputs incoming serial data one byte at a time, returns -1 if no data is available. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>8-bit signed integer (int8_t) - the first byte of incoming data or returns -1 if no data available.</dd></dl>
<p>Example: </p>
<div class="fragment"><pre class="fragment">        <span class="comment">// Define and receive a serial byte</span>
        int8_t myByte = <a class="code" href="group__serial.html#ga02db400d599afe33dceff17cd281f8c3" title="Inputs incoming serial data one byte at a time, returns -1 if no data is available.">serial_in</a>();

        <span class="comment">// Is it &#39;!&#39;</span>
        <span class="keywordflow">if</span>(myByte == <span class="charliteral">&#39;!&#39;</span>)
        {
                process_exclamation();
        }       
</pre></div> 
<p>Definition at line <a class="el" href="serial__in_8c_source.html#l00041">41</a> of file <a class="el" href="serial__in_8c_source.html">serial_in.c</a>.</p>

</div>
</div>
<a class="anchor" id="gafa8f73ae47320346b1efb251ac188d45"></a><!-- doxytag: member="serial.h::serial_out" ref="gafa8f73ae47320346b1efb251ac188d45" args="(const char *fmt,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void serial_out </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>fmt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&nbsp;</td>
          <td class="paramname"> <em>...</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Outputs formatted data based on conversion symbols and escape character sequences contained in a string of text. Syntax: serial_out(string_with_N_data_format_symbols, data1, data2, ... dataN);. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buff</em>&nbsp;</td><td>pointer to a string with format data. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>uint8_t number of characters in the buffer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of characters printed or a negative number if an error occurred.</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>Conversion symbols: c - print an ASCII character s - print a character string d or i - print a decimal integer x - print a hexadecimal integer. Note that we usually precede this with the characters 0x to output, for instance if the hexadecimal number is 5A, the output will be 0x5A.</dd></dl>
<p>Control characters: <br/>
 - print a new line " - print a quotation mark \ - print a forward slash</p>
<p>Examples: </p>
<div class="fragment"><pre class="fragment">        Example 1: 
        uint8_t my_char = <span class="charliteral">&#39;!&#39;</span>;
        uint8_t my_string[] = { <span class="charliteral">&#39;H&#39;</span>, <span class="charliteral">&#39;e&#39;</span>, <span class="charliteral">&#39;l&#39;</span>, <span class="charliteral">&#39;l&#39;</span>, <span class="charliteral">&#39;o&#39;</span>, 0};
        my_byte = 42;

        <a class="code" href="group__serial.html#gafa8f73ae47320346b1efb251ac188d45" title="Outputs formatted data based on conversion symbols and escape character sequences contained in a stri...">serial_out</a>(<span class="stringliteral">&quot;Print a character: %c, a string: %c, a decimal integer: %d, a hexadecimal integer: 0x%X, a forward slash: \\, a quote: \&quot;, a new line: \n next line.&quot;</span>, my_char, my_string, my_byte, my_byte);

        Which shows in the terminal as: 
        Print a character: !, a <span class="keywordtype">string</span>: Hello, a decimal integer: 42, a hexadecimal integer: 0x2A, a forward slash \, a quote <span class="stringliteral">&quot;, and a new line:</span>
<span class="stringliteral">        next line.</span>
<span class="stringliteral"></span>
<span class="stringliteral">        Example 2:</span>
<span class="stringliteral">        uint8_t  my_day = 21;</span>
<span class="stringliteral">        uint8_t my_month[] = {&#39;J&#39;,&#39;u&#39;,&#39;l&#39;,&#39;y&#39;,0};</span>
<span class="stringliteral">        uint16_t my_year = 1980;</span>
<span class="stringliteral"></span>
<span class="stringliteral">        serial_out( &quot;</span>Your date of birth is:\n Day %d \nMonth: %s  \nYear %d.<span class="stringliteral">&quot;, my_day, my_month, my_year); </span>
<span class="stringliteral"></span>
<span class="stringliteral">        Which shows in the terminal as: </span>
<span class="stringliteral"></span>
<span class="stringliteral">        Your date of birth is:</span>
<span class="stringliteral">        Day 21</span>
<span class="stringliteral">        Month July</span>
<span class="stringliteral">        Year 1980</span>
</pre></div><dl class="note"><dt><b>Note:</b></dt><dd>More advanced users may note that this is a macro wrapper for the C Standard Library printf() function with the string stored in flash and the output directed to the USART, but the documentation here is kept simple for use by novices. If you want to use floating point conversions - DON'T. That facility is not included since it causes the code size to increase more than is warranted by the convenience. If you really need floating point consider using the special printf() functions as documented in avrlibc. </dd></dl>

<p>Definition at line <a class="el" href="serial__out_8c_source.html#l00045">45</a> of file <a class="el" href="serial__out_8c_source.html">serial_out.c</a>.</p>

</div>
</div>
<a class="anchor" id="gaf5d688600f05137b44dd915a9bb0686c"></a><!-- doxytag: member="serial.h::serial_write" ref="gaf5d688600f05137b44dd915a9bb0686c" args="(uint8_t *buff, uint8_t size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void serial_write </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&nbsp;</td>
          <td class="paramname"> <em>buff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Outputs the indicated number of bytes. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>*buff</em>&nbsp;</td><td>a pointer to a uint8_t buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>uint8_t number of buffer elements to output</td></tr>
  </table>
  </dd>
</dl>
<p>Example: </p>
<div class="fragment"><pre class="fragment">        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; count; i++)
        {
                buf[i] = <a class="code" href="group__serial.html#ga02db400d599afe33dceff17cd281f8c3" title="Inputs incoming serial data one byte at a time, returns -1 if no data is available.">serial_in</a>();
        }
                        
        <a class="code" href="group__serial.html#gaf5d688600f05137b44dd915a9bb0686c" title="Outputs the indicated number of bytes.">serial_write</a>(buf,count);
</pre></div> 
<p>Definition at line <a class="el" href="serial_8c_source.html#l00145">145</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Wed Sep 14 2011 16:28:31 for libavr by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
